
import (
	"std.um"
	"common.um"
	"../umbox/http/http.um"
	"../umbox/io/io.um"
)

fn run*(url: str, argi: int): std.Err {
	if argi != std.argc() - 1 {
		fprintf(std.stderr(), "Usage: umbox register <query>\n")
		return {}
	}
	
	name := std.argv(argi)

	w := io.mkMemory({})
	resp := common.get(url, sprintf("api/register/%s", name))
	if !resp.ok {
		return std.error(1, resp.msg)
	}
     
	printf("%s\n", str(resp.data))

	return {}
}
