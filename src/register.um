
import (
	"std.um"
	"../umbox/http/http.um"
	"../umbox/io/io.um"
)

fn run*(url: str, argi: int) {
	if argi != std.argc() - 1 {
		fprintf(std.stderr(), "Usage: umbox register <query>\n")
		return
	}
	
	name := std.argv(argi)

	w := io.mkMemory({})
	resp := http.get(sprintf("%s/api/register/%s", url, name), w)
	if !resp.ok {
		fprintf(std.stderr(), "Registering failed: %s", resp.err)
		return
	}
	      
	fprintf(std.stderr(), "%s\n", str([]char(w.read())))
}
