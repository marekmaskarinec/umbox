
import (
	"../umbox/http/http.um"
	"../umbox/io/io.um"
	"../umbox/json/json.um"
	"std.um"
	
	"common.um"
)

fn run*(url: str, argi: int) {
	if argi != std.argc() - 1 {
		fprintf(std.stderr(), "Usage: umbox search <query>\n")
		return
	}

	query := std.argv(argi)

	resp := common.get(url, sprintf("api/search/%s", query))
	if !resp.ok {
		error(resp.msg)
	}

	res := []any(resp.data)
	for _,r in res {
		o := map[str]any(r)
		printf("%s - %s\n", str(o["name"]), str(o["description"]))
	}
}
